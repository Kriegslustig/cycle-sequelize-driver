"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function makeSequelizeDriver(e){if(!Sequelize.prototype.isPrototypeOf(e))throw Error("makeSequelizeDriver expects parameter 1 to be an instance of Sequelize");var r=(0,_immutable.Map)({sequelize:e,model:(0,_immutable.Map)()});return function(t){return _rx.Observable.merge(t.filter(isKey(_define.defineKey)).flatMap(function(r){var t=(0,_toArray3["default"])(r),i=(t[0],t.slice(1));return(0,_define.executeDefinitions)(e,i)}).map(function(e){return r=r.merge(e)}),t.filter(isKey(_create.createKey)).flatMap(function(e){var t=(0,_toArray3["default"])(e),i=(t[0],t.slice(1));return _create.executeCreates.apply(void 0,[r].concat((0,_toConsumableArray3["default"])(i)))}),t.filter(isKey([_create.createKey,_define.defineKey],!0)).map(function(e){throw new Error("Undefined operation: "+e)}))}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.findAll=exports.findOne=exports.create=exports.define=void 0;var _toConsumableArray2=require("babel-runtime/helpers/toConsumableArray"),_toConsumableArray3=_interopRequireDefault(_toConsumableArray2),_toArray2=require("babel-runtime/helpers/toArray"),_toArray3=_interopRequireDefault(_toArray2);exports.makeSequelizeDriver=makeSequelizeDriver;var _rx=require("rx"),_immutable=require("immutable"),_define=require("./lib/define"),_create=require("./lib/create"),_findOne=require("./lib/findOne"),_findAll=require("./lib/findAll"),Sequelize=require("sequelize");exports.define=_define.define,exports.create=_create.create,exports.findOne=_findOne.findOne,exports.findAll=_findAll.findAll;var isKey=function(e){var r=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return Array.prototype.isPrototypeOf(e)?function(t){var i=(0,_toArray3["default"])(t),n=i[0];i.slice(1);return r?-1===e.indexOf(n):e.indexOf(n)>-1}:function(t){var i=(0,_toArray3["default"])(t),n=i[0];i.slice(1);return r?e!==n:e===n}};